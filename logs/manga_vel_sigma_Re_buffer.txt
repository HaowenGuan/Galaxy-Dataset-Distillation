C:\Users\EXCAE\PycharmProjects\Galaxy-Dataset-Distillation\venv\Scripts\python.exe C:/Users/EXCAE/PycharmProjects/Galaxy-Dataset-Distillation/buffer.py --dataset=dl-DR17-Pipe3D --model=ConvNet --train_epochs=20 --num_experts=10 --batch_train=64 --buffer_path={path_to_buffer_storage} --data_path={path_to_dataset}
Console output is saving to: C:\Users\EXCAE\PycharmProjects\logs
  0%|          | 0/7890 [00:00<?, ?it/s]Hyper-parameters:
 {'dataset': 'dl-DR17-Pipe3D', 'subset': 'imagenette', 'model': 'ConvNet', 'num_experts': 10, 'lr_teacher': 0.01, 'batch_train': 64, 'batch_real': 256, 'dsa': True, 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': '{path_to_dataset}', 'buffer_path': '{path_to_buffer_storage}', 'train_epochs': 20, 'zca': False, 'decay': False, 'mom': 0, 'l2': 0, 'save_interval': 10, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x000001B187D7CD08>}
BUILDING DATASET
100%|██████████| 7890/7890 [00:00<00:00, 157655.81it/s]
7890it [00:00, 3941996.25it/s]
class c = 0: 802 real images
class c = 1: 783 real images
class c = 2: 798 real images
class c = 3: 778 real images
class c = 4: 792 real images
class c = 5: 780 real images
class c = 6: 788 real images
class c = 7: 787 real images
class c = 8: 791 real images
class c = 9: 791 real images
real images channel 0, mean = -0.0088, std = 0.9741
real images channel 1, mean = -0.0078, std = 0.9741
real images channel 2, mean = -0.0075, std = 0.9769
Add weight to loss function tensor([0.9837, 1.0076, 0.9886, 1.0141, 0.9961, 1.0115, 1.0012, 1.0025, 0.9974,
        0.9974])
DC augmentation parameters:
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'crop_scale_rotate'}
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 0	Epoch: 0	Train Acc: 0.14816223067173637	Test Acc: 0.17992904206791688	AVG Train loss: 0.18035060961191343	AVG Test loss: 0.3285956280490075
Itr: 0	Epoch: 1	Train Acc: 0.1988593155893536	Test Acc: 0.1915864166244298	AVG Train loss: 0.16798420074113724	AVG Test loss: 0.32269423056603447
Itr: 0	Epoch: 2	Train Acc: 0.21039290240811154	Test Acc: 0.21794221996958946	AVG Train loss: 0.1653759957587462	AVG Test loss: 0.3255528177456148
Itr: 0	Epoch: 3	Train Acc: 0.22864385297845374	Test Acc: 0.21591485048150025	AVG Train loss: 0.16261627167198897	AVG Test loss: 0.3225844742393228
Itr: 0	Epoch: 4	Train Acc: 0.24245880861850444	Test Acc: 0.21490116573745566	AVG Train loss: 0.1610706248531928	AVG Test loss: 0.31597166594912784
Itr: 0	Epoch: 5	Train Acc: 0.24828897338403041	Test Acc: 0.2397364419665484	AVG Train loss: 0.15792441792757791	AVG Test loss: 0.3152782469081564
Itr: 0	Epoch: 6	Train Acc: 0.25665399239543724	Test Acc: 0.21388748099341104	AVG Train loss: 0.15752236709111997	AVG Test loss: 0.3118124270704997
Itr: 0	Epoch: 7	Train Acc: 0.2600760456273764	Test Acc: 0.230613279270147	AVG Train loss: 0.15687649401686188	AVG Test loss: 0.3150037710686595
Itr: 0	Epoch: 8	Train Acc: 0.2643852978453739	Test Acc: 0.22098327420172326	AVG Train loss: 0.15591518815762642	AVG Test loss: 0.31265754090670217
Itr: 0	Epoch: 9	Train Acc: 0.27579214195183777	Test Acc: 0.22858590978205778	AVG Train loss: 0.15407350790629065	AVG Test loss: 0.30883627201751956
Itr: 0	Epoch: 10	Train Acc: 0.2707224334600761	Test Acc: 0.22807906741003547	AVG Train loss: 0.15382933265544918	AVG Test loss: 0.3080460680238015
Itr: 0	Epoch: 11	Train Acc: 0.2817490494296578	Test Acc: 0.2321338063862139	AVG Train loss: 0.15309160301421681	AVG Test loss: 0.30850876082307
Itr: 0	Epoch: 12	Train Acc: 0.28453738910012677	Test Acc: 0.2397364419665484	AVG Train loss: 0.1519861965493331	AVG Test loss: 0.3085571271449977
Itr: 0	Epoch: 13	Train Acc: 0.29391634980988596	Test Acc: 0.24125696908261532	AVG Train loss: 0.1506857271987298	AVG Test loss: 0.30855356912835263
Itr: 0	Epoch: 14	Train Acc: 0.30063371356147023	Test Acc: 0.22807906741003547	AVG Train loss: 0.15063563930425505	AVG Test loss: 0.30663431427893273
Itr: 0	Epoch: 15	Train Acc: 0.30595690747782	Test Acc: 0.2422706538266599	AVG Train loss: 0.14824338580171267	AVG Test loss: 0.3083166171845239
Itr: 0	Epoch: 16	Train Acc: 0.3103929024081115	Test Acc: 0.22605169792194627	AVG Train loss: 0.1488861499073312	AVG Test loss: 0.30865007227317853
Itr: 0	Epoch: 17	Train Acc: 0.32344740177439796	Test Acc: 0.22959959452610237	AVG Train loss: 0.14567656124574904	AVG Test loss: 0.30387984706373067
Itr: 0	Epoch: 18	Train Acc: 0.31077313054499367	Test Acc: 0.2351748606183477	AVG Train loss: 0.14791371118093172	AVG Test loss: 0.3046324551105499
Itr: 0	Epoch: 19	Train Acc: 0.3153358681875792	Test Acc: 0.2382159148504815	AVG Train loss: 0.14734285652958545	AVG Test loss: 0.3041105449909615
train set ACC of each class tensor([0.0516, 0.0535, 0.0478, 0.0264, 0.0255, 0.0570, 0.0209, 0.0460, 0.0490,
        0.0445])
[[407 217 115  17   9  26   1   2   4   4]
 [ 69 422 132  44  29  65  11   3   3   5]
 [ 42 119 377  51  38 112   7  16  22  14]
 [ 18  91 130 208  41 174  18  45  28  25]
 [  8  59 114  52 201 216  18  45  48  31]
 [  4  33  55  31  30 450  17  71  60  29]
 [  5  13  25  34  49 221 165 112 103  61]
 [  2   9  25  20  20 134  27 363 108  79]
 [  2  13  19  11  18 117  30 116 387  78]
 [  3   8  14  19  13  89  13 103 178 351]]
test set ACC of each class tensor([0.0329, 0.0385, 0.0314, 0.0137, 0.0106, 0.0375, 0.0041, 0.0264, 0.0213,
        0.0218])
[[65 68 37  8  6  4  0  0  1  0]
 [34 76 55 11  7 13  2  5  1  0]
 [14 31 62 16 13 37  2  2  8  8]
 [ 7 24 45 27 19 48  6 15 12 10]
 [ 2 15 26 15 21 75  5 14 19  4]
 [ 2 14 13 19 16 74  9 19 25 15]
 [ 0  2 12 11  6 64  8 35 35 20]
 [ 1  1  9  5  7 54  9 52 36 14]
 [ 0  1  4  5 10 38  8 57 42 30]
 [ 1  2  8  2  8 29  4 36 63 43]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 1	Epoch: 0	Train Acc: 0.14790874524714828	Test Acc: 0.19918905220476432	AVG Train loss: 0.18260287639834885	AVG Test loss: 0.32911889321509197
Itr: 1	Epoch: 1	Train Acc: 0.1988593155893536	Test Acc: 0.20831221490116575	AVG Train loss: 0.16774748774913478	AVG Test loss: 0.3285315116150876
Itr: 1	Epoch: 2	Train Acc: 0.21888466413181243	Test Acc: 0.22807906741003547	AVG Train loss: 0.16464517544223178	AVG Test loss: 0.3148131369713654
Itr: 1	Epoch: 3	Train Acc: 0.22040557667934094	Test Acc: 0.22098327420172326	AVG Train loss: 0.16271638659564414	AVG Test loss: 0.3161154843742208
Itr: 1	Epoch: 4	Train Acc: 0.22991128010139417	Test Acc: 0.22250380131779016	AVG Train loss: 0.1615392635379303	AVG Test loss: 0.31338849125238344
Itr: 1	Epoch: 5	Train Acc: 0.2420785804816223	Test Acc: 0.21692853522554487	AVG Train loss: 0.15969944186933593	AVG Test loss: 0.3107590733508561
Itr: 1	Epoch: 6	Train Acc: 0.2509505703422053	Test Acc: 0.2290927521540801	AVG Train loss: 0.15777566358447076	AVG Test loss: 0.31372898379015063
Itr: 1	Epoch: 7	Train Acc: 0.25804816223067173	Test Acc: 0.22149011657374557	AVG Train loss: 0.1568999278152548	AVG Test loss: 0.31011206319473505
Itr: 1	Epoch: 8	Train Acc: 0.2697084917617237	Test Acc: 0.240750126710593	AVG Train loss: 0.15628497365234167	AVG Test loss: 0.3103178147730704
Itr: 1	Epoch: 9	Train Acc: 0.2719898605830165	Test Acc: 0.21439432336543335	AVG Train loss: 0.1551517011755924	AVG Test loss: 0.31043421960064316
Itr: 1	Epoch: 10	Train Acc: 0.27756653992395436	Test Acc: 0.23162696401419158	AVG Train loss: 0.15431629872971767	AVG Test loss: 0.3131055585092176
Itr: 1	Epoch: 11	Train Acc: 0.2808618504435995	Test Acc: 0.2321338063862139	AVG Train loss: 0.15335575464749365	AVG Test loss: 0.3076014766083474
Itr: 1	Epoch: 12	Train Acc: 0.29721166032953106	Test Acc: 0.22149011657374557	AVG Train loss: 0.15075436693312852	AVG Test loss: 0.30949387260940675
Itr: 1	Epoch: 13	Train Acc: 0.2967046894803549	Test Acc: 0.2351748606183477	AVG Train loss: 0.1503156276832893	AVG Test loss: 0.30510087789343626
Itr: 1	Epoch: 14	Train Acc: 0.30519645120405575	Test Acc: 0.22655854029396857	AVG Train loss: 0.14942140789992908	AVG Test loss: 0.3070957264921959
Itr: 1	Epoch: 15	Train Acc: 0.2997465145754119	Test Acc: 0.2321338063862139	AVG Train loss: 0.15009918436313613	AVG Test loss: 0.3124614576443282
Itr: 1	Epoch: 16	Train Acc: 0.30963244613434726	Test Acc: 0.23568170299037	AVG Train loss: 0.14869576872754914	AVG Test loss: 0.3046981462414834
Itr: 1	Epoch: 17	Train Acc: 0.30684410646387833	Test Acc: 0.22402432843385708	AVG Train loss: 0.148883867771831	AVG Test loss: 0.3063359732441774
Itr: 1	Epoch: 18	Train Acc: 0.3178707224334601	Test Acc: 0.2397364419665484	AVG Train loss: 0.14825817333069288	AVG Test loss: 0.30785164653922603
Itr: 1	Epoch: 19	Train Acc: 0.33105196451204055	Test Acc: 0.2341611758743031	AVG Train loss: 0.14692254338616503	AVG Test loss: 0.30727486072218607
train set ACC of each class tensor([0.0733, 0.0251, 0.0621, 0.0270, 0.0151, 0.0385, 0.0560, 0.0240, 0.0347,
        0.0584])
[[578  36 146  16   2   6   9   1   1   7]
 [213 198 255  38   8  22  35   4   4   6]
 [115  22 490  39   7  42  42   2   6  33]
 [ 61  27 243 213  12  64  95  13  10  40]
 [ 38  22 187  78 119 114 133  19  26  56]
 [ 17  16 108  50  18 304 140  26  30  71]
 [ 12   9  69  34  10  54 442  28  44  86]
 [  4   4  56  19   8  72 203 189  71 161]
 [  6   6  42  15   7  53 168  52 274 168]
 [  5   1  44  14   5  38 104  44  75 461]]
test set ACC of each class tensor([0.0547, 0.0152, 0.0411, 0.0157, 0.0056, 0.0208, 0.0279, 0.0122, 0.0106,
        0.0304])
[[108  22  51   3   0   3   2   0   0   0]
 [ 78  30  70   9   3   3   6   1   3   1]
 [ 31  13  81  20   2  20  11   2   4   9]
 [ 20  10  64  31   6  20  33   4   6  19]
 [  9   8  48  20  11  37  35   6   8  14]
 [  7   7  33  25   5  41  45   9  13  21]
 [  1   2  18  15   6  28  55  13  24  31]
 [  1   2  17   9   4  22  66  24  15  28]
 [  1   1  13   5   0  16  54  28  21  56]
 [  1   1  15   6   0  12  36  18  47  60]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 2	Epoch: 0	Train Acc: 0.1523447401774398	Test Acc: 0.1941206284845413	AVG Train loss: 0.18111461323080408	AVG Test loss: 0.33298573924301245
Itr: 2	Epoch: 1	Train Acc: 0.20519645120405577	Test Acc: 0.1956411556006082	AVG Train loss: 0.16854611094875782	AVG Test loss: 0.3238102349830773
Itr: 2	Epoch: 2	Train Acc: 0.21825095057034222	Test Acc: 0.21591485048150025	AVG Train loss: 0.1652301191528185	AVG Test loss: 0.32399294024273884
Itr: 2	Epoch: 3	Train Acc: 0.23079847908745246	Test Acc: 0.22301064368981247	AVG Train loss: 0.16358061858248651	AVG Test loss: 0.3180022757487193
Itr: 2	Epoch: 4	Train Acc: 0.23396704689480355	Test Acc: 0.21236695387734414	AVG Train loss: 0.16078144936280558	AVG Test loss: 0.3148690093850582
Itr: 2	Epoch: 5	Train Acc: 0.24651457541191382	Test Acc: 0.2397364419665484	AVG Train loss: 0.15961292547625885	AVG Test loss: 0.3135944678737497
Itr: 2	Epoch: 6	Train Acc: 0.25462610899873256	Test Acc: 0.22047643182970098	AVG Train loss: 0.1582741316497628	AVG Test loss: 0.31435047987295295
Itr: 2	Epoch: 7	Train Acc: 0.2661596958174905	Test Acc: 0.22047643182970098	AVG Train loss: 0.1562308902201846	AVG Test loss: 0.314626101047571
Itr: 2	Epoch: 8	Train Acc: 0.267553865652725	Test Acc: 0.22351748606183477	AVG Train loss: 0.15562870850071253	AVG Test loss: 0.31337629873409406
Itr: 2	Epoch: 9	Train Acc: 0.270595690747782	Test Acc: 0.2422706538266599	AVG Train loss: 0.15516947479529072	AVG Test loss: 0.31251576701457645
Itr: 2	Epoch: 10	Train Acc: 0.2921419518377693	Test Acc: 0.23466801824632538	AVG Train loss: 0.15303525837711962	AVG Test loss: 0.3085140238029366
Itr: 2	Epoch: 11	Train Acc: 0.2812420785804816	Test Acc: 0.22706538266599088	AVG Train loss: 0.1533353662460627	AVG Test loss: 0.308042386462709
Itr: 2	Epoch: 12	Train Acc: 0.2879594423320659	Test Acc: 0.20932589964521034	AVG Train loss: 0.15154035665160953	AVG Test loss: 0.3101622135247667
Itr: 2	Epoch: 13	Train Acc: 0.2944233206590621	Test Acc: 0.23618854536239228	AVG Train loss: 0.1507467434527907	AVG Test loss: 0.30687987061242916
Itr: 2	Epoch: 14	Train Acc: 0.3017743979721166	Test Acc: 0.2321338063862139	AVG Train loss: 0.15029890339051968	AVG Test loss: 0.30868649081687183
Itr: 2	Epoch: 15	Train Acc: 0.3024081115335868	Test Acc: 0.22959959452610237	AVG Train loss: 0.14987462008766197	AVG Test loss: 0.3080894652653997
Itr: 2	Epoch: 16	Train Acc: 0.31685678073510776	Test Acc: 0.23162696401419158	AVG Train loss: 0.1487141607171078	AVG Test loss: 0.3047209942908802
Itr: 2	Epoch: 17	Train Acc: 0.31102661596958175	Test Acc: 0.2336543335022808	AVG Train loss: 0.14885798376549333	AVG Test loss: 0.3076149354534468
Itr: 2	Epoch: 18	Train Acc: 0.320659062103929	Test Acc: 0.2341611758743031	AVG Train loss: 0.14813650177062238	AVG Test loss: 0.31198088484129444
Itr: 2	Epoch: 19	Train Acc: 0.33561470215462613	Test Acc: 0.2382159148504815	AVG Train loss: 0.1449088407248372	AVG Test loss: 0.30947778527650865
train set ACC of each class tensor([0.0714, 0.0504, 0.0374, 0.0219, 0.0350, 0.0240, 0.0508, 0.0483, 0.0228,
        0.0672])
[[563 113  59  18  14   9  12   3   0  11]
 [164 398  68  28  38  17  32  19   3  16]
 [117 117 295  40  63  26  52  27   7  54]
 [ 60  97  94 173  93  42 100  47   7  65]
 [ 37  48  59  27 276  46 133  71  16  79]
 [ 14  34  39  28  66 189 170 120  25  95]
 [  9  20  13  13  45  26 401 122  23 116]
 [  3  12  16   6  25  26 119 381  25 174]
 [  8   9  12   9  14  15 110 169 180 265]
 [  5  11   3   5  20  11  63 104  39 530]]
test set ACC of each class tensor([0.0532, 0.0289, 0.0182, 0.0076, 0.0198, 0.0091, 0.0238, 0.0233, 0.0056,
        0.0487])
[[105  48  16   5   8   2   4   0   0   1]
 [ 75  57  30  11  10   2   9   6   0   4]
 [ 35  35  36  12  20  10  22   5   3  15]
 [ 14  31  30  15  26  17  40  13   3  24]
 [ 12  12  16  13  39  22  34  22   3  23]
 [  6  17   7  10  24  18  56  30   8  30]
 [  0   6   4   6  16  13  47  43  10  48]
 [  0   2   4   5   9  12  50  46   7  53]
 [  0   2   2   1  10   8  35  60  11  66]
 [  1   3   5   1   7   5  25  38  15  96]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 3	Epoch: 0	Train Acc: 0.15551330798479088	Test Acc: 0.198682209832742	AVG Train loss: 0.18212989421020745	AVG Test loss: 0.32759002536097215
Itr: 3	Epoch: 1	Train Acc: 0.19923954372623573	Test Acc: 0.20273694880892043	AVG Train loss: 0.1678508327780492	AVG Test loss: 0.32524387935696675
Itr: 3	Epoch: 2	Train Acc: 0.21229404309252217	Test Acc: 0.20679168778509882	AVG Train loss: 0.16573960549553388	AVG Test loss: 0.322490064824709
Itr: 3	Epoch: 3	Train Acc: 0.2291508238276299	Test Acc: 0.21135326913329955	AVG Train loss: 0.16277380824391227	AVG Test loss: 0.3215062368493121
Itr: 3	Epoch: 4	Train Acc: 0.22167300380228136	Test Acc: 0.22858590978205778	AVG Train loss: 0.16229475051240172	AVG Test loss: 0.3162498365288994
Itr: 3	Epoch: 5	Train Acc: 0.23954372623574144	Test Acc: 0.22605169792194627	AVG Train loss: 0.16007669221501236	AVG Test loss: 0.31547493981154995
Itr: 3	Epoch: 6	Train Acc: 0.2449936628643853	Test Acc: 0.22149011657374557	AVG Train loss: 0.1585582461798297	AVG Test loss: 0.3137484123062737
Itr: 3	Epoch: 7	Train Acc: 0.25576679340937897	Test Acc: 0.21946274708565636	AVG Train loss: 0.1568918235939945	AVG Test loss: 0.31179830496890015
Itr: 3	Epoch: 8	Train Acc: 0.2660329531051964	Test Acc: 0.22503801317790167	AVG Train loss: 0.156005233474293	AVG Test loss: 0.31069772014204644
Itr: 3	Epoch: 9	Train Acc: 0.2581749049429658	Test Acc: 0.2351748606183477	AVG Train loss: 0.15662410008627803	AVG Test loss: 0.3105679527038375
Itr: 3	Epoch: 10	Train Acc: 0.2692015209125475	Test Acc: 0.22554485554992398	AVG Train loss: 0.15485543505830457	AVG Test loss: 0.3078177395624614
Itr: 3	Epoch: 11	Train Acc: 0.2832699619771863	Test Acc: 0.240750126710593	AVG Train loss: 0.15390612994366726	AVG Test loss: 0.3083139134960856
Itr: 3	Epoch: 12	Train Acc: 0.2826362484157161	Test Acc: 0.23010643689812468	AVG Train loss: 0.15251303735756905	AVG Test loss: 0.3145340232002028
Itr: 3	Epoch: 13	Train Acc: 0.2902408111533587	Test Acc: 0.24429802331474912	AVG Train loss: 0.15219089902361385	AVG Test loss: 0.31290534830492156
Itr: 3	Epoch: 14	Train Acc: 0.2904942965779468	Test Acc: 0.2290927521540801	AVG Train loss: 0.15061980686770193	AVG Test loss: 0.3054957608099946
Itr: 3	Epoch: 15	Train Acc: 0.28403041825095054	Test Acc: 0.2382159148504815	AVG Train loss: 0.1511000507410866	AVG Test loss: 0.3070053148786247
Itr: 3	Epoch: 16	Train Acc: 0.31368821292775667	Test Acc: 0.24784591991890523	AVG Train loss: 0.14916610472159242	AVG Test loss: 0.3051061827898992
Itr: 3	Epoch: 17	Train Acc: 0.3115335868187579	Test Acc: 0.2366953877344146	AVG Train loss: 0.14895360546023673	AVG Test loss: 0.3079588152373798
Itr: 3	Epoch: 18	Train Acc: 0.3060836501901141	Test Acc: 0.240750126710593	AVG Train loss: 0.1488516363382566	AVG Test loss: 0.30543023523073537
Itr: 3	Epoch: 19	Train Acc: 0.31406844106463877	Test Acc: 0.22757222503801317	AVG Train loss: 0.1467767296672925	AVG Test loss: 0.3076338742477786
train set ACC of each class tensor([0.0527, 0.0616, 0.0428, 0.0366, 0.0373, 0.0350, 0.0337, 0.0435, 0.0418,
        0.0191])
[[416 262  70  21  13   7   4   6   3   0]
 [ 73 486  95  54  36  15  13   5   6   0]
 [ 51 183 338  81  46  31  31  20  13   4]
 [ 23 140 116 289  59  56  33  33  25   4]
 [ 16  81 101  88 294  86  38  43  38   7]
 [  4  59  58  79 112 276  55  71  58   8]
 [  1  38  37  68  92 111 266  85  78  12]
 [  0  20  26  47  72 111  63 343  90  15]
 [  0  26  18  37  48  69  87 163 330  13]
 [  2  22  25  33  48  45  87 186 192 151]]
test set ACC of each class tensor([0.0309, 0.0492, 0.0258, 0.0203, 0.0228, 0.0182, 0.0122, 0.0223, 0.0172,
        0.0086])
[[61 94 21  5  5  3  0  0  0  0]
 [35 97 39 14  8  5  1  3  1  1]
 [19 47 51 24 15 17  5  6  6  3]
 [ 7 38 38 40 38 18 11 10 12  1]
 [ 6 21 23 30 45 33 13 13 10  2]
 [ 2 21 19 28 34 36 22 22 20  2]
 [ 0  6 12 25 23 35 24 33 32  3]
 [ 3  3  7 16 21 30 32 44 30  2]
 [ 1  5  6  8 18 15 35 64 34  9]
 [ 1  3  9 10 14 13 17 54 58 17]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 4	Epoch: 0	Train Acc: 0.1429657794676806	Test Acc: 0.21135326913329955	AVG Train loss: 0.18231768736518986	AVG Test loss: 0.3308718002769951
Itr: 4	Epoch: 1	Train Acc: 0.1944233206590621	Test Acc: 0.21490116573745566	AVG Train loss: 0.1695427131828473	AVG Test loss: 0.325274253074312
Itr: 4	Epoch: 2	Train Acc: 0.21609632446134347	Test Acc: 0.21895590471363405	AVG Train loss: 0.16496405682617418	AVG Test loss: 0.32045108999054384
Itr: 4	Epoch: 3	Train Acc: 0.22306717363751585	Test Acc: 0.20983274201723265	AVG Train loss: 0.16345101617210567	AVG Test loss: 0.31708324321834075
Itr: 4	Epoch: 4	Train Acc: 0.23269961977186313	Test Acc: 0.23314749113025848	AVG Train loss: 0.16204019916469303	AVG Test loss: 0.313460474230587
Itr: 4	Epoch: 5	Train Acc: 0.23688212927756655	Test Acc: 0.2336543335022808	AVG Train loss: 0.16053740534983357	AVG Test loss: 0.31387914594091015
Itr: 4	Epoch: 6	Train Acc: 0.24879594423320658	Test Acc: 0.22047643182970098	AVG Train loss: 0.15857778698848077	AVG Test loss: 0.31328445864823407
Itr: 4	Epoch: 7	Train Acc: 0.2602027883396705	Test Acc: 0.22250380131779016	AVG Train loss: 0.15734296390652203	AVG Test loss: 0.31214244169024
Itr: 4	Epoch: 8	Train Acc: 0.2660329531051964	Test Acc: 0.2372022301064369	AVG Train loss: 0.15549562924337326	AVG Test loss: 0.3111677170404008
Itr: 4	Epoch: 9	Train Acc: 0.26996197718631176	Test Acc: 0.22605169792194627	AVG Train loss: 0.15445918305310763	AVG Test loss: 0.3110160923327399
Itr: 4	Epoch: 10	Train Acc: 0.28453738910012677	Test Acc: 0.22149011657374557	AVG Train loss: 0.15236558523241558	AVG Test loss: 0.31332794399776254
Itr: 4	Epoch: 11	Train Acc: 0.2859315589353612	Test Acc: 0.22503801317790167	AVG Train loss: 0.15146102270793704	AVG Test loss: 0.3087528394719277
Itr: 4	Epoch: 12	Train Acc: 0.2899873257287706	Test Acc: 0.23010643689812468	AVG Train loss: 0.1516215454319584	AVG Test loss: 0.3078558501016653
Itr: 4	Epoch: 13	Train Acc: 0.2904942965779468	Test Acc: 0.23568170299037	AVG Train loss: 0.1517556077381655	AVG Test loss: 0.30703038824613604
Itr: 4	Epoch: 14	Train Acc: 0.30456273764258557	Test Acc: 0.22807906741003547	AVG Train loss: 0.14961396980516056	AVG Test loss: 0.31635914531475506
Itr: 4	Epoch: 15	Train Acc: 0.30367553865652724	Test Acc: 0.2290927521540801	AVG Train loss: 0.14990092926530027	AVG Test loss: 0.3065906287040193
Itr: 4	Epoch: 16	Train Acc: 0.31191381495564	Test Acc: 0.21946274708565636	AVG Train loss: 0.14935860624690322	AVG Test loss: 0.3060678359493047
Itr: 4	Epoch: 17	Train Acc: 0.31394169835234476	Test Acc: 0.2382159148504815	AVG Train loss: 0.14723238800150662	AVG Test loss: 0.30388256339512076
Itr: 4	Epoch: 18	Train Acc: 0.31685678073510776	Test Acc: 0.23314749113025848	AVG Train loss: 0.14830783220959404	AVG Test loss: 0.306588474342017
Itr: 4	Epoch: 19	Train Acc: 0.3405576679340938	Test Acc: 0.2453117080587937	AVG Train loss: 0.14565441444119573	AVG Test loss: 0.31057891417323064
train set ACC of each class tensor([0.0670, 0.0578, 0.0337, 0.0289, 0.0523, 0.0264, 0.0423, 0.0196, 0.0234,
        0.0608])
[[529 175  45  15  23   2   6   2   1   4]
 [132 456  62  31  65  12  13   3   1   8]
 [112 181 266  48 110  18  26   2   1  34]
 [ 52 135  92 228 129  33  50   7   6  46]
 [ 25  78  81  35 413  47  41   8  12  52]
 [ 14  60  44  54 205 208  89  13  23  70]
 [  8  33  24  41 172  33 334  20  20 103]
 [  2  24  20  27 146  52 133 155  43 185]
 [  4  17  18  24  89  70 122  44 185 218]
 [  2  14  16  17  82  28  70  37  45 480]]
test set ACC of each class tensor([0.0492, 0.0426, 0.0182, 0.0137, 0.0360, 0.0091, 0.0198, 0.0076, 0.0071,
        0.0421])
[[97 65 14  2 10  1  0  0  0  0]
 [59 84 24 12 15  3  1  3  2  1]
 [29 44 36 16 36 11  6  1  3 11]
 [15 32 33 27 60  8 17  3  5 13]
 [ 7 22 20 12 71 23 20  1  4 16]
 [ 5 25  7 15 68 18 30  7  8 23]
 [ 1  8 11 14 44 21 39  9  6 40]
 [ 0  4  6 13 42 20 45 15  8 35]
 [ 0  4  7  2 34 16 42 20 14 56]
 [ 1  4  6  4 27  7 29 14 21 83]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 5	Epoch: 0	Train Acc: 0.16197718631178706	Test Acc: 0.1956411556006082	AVG Train loss: 0.1808466989986117	AVG Test loss: 0.33327319209066913
Itr: 5	Epoch: 1	Train Acc: 0.20139416983523448	Test Acc: 0.21135326913329955	AVG Train loss: 0.1680173715408915	AVG Test loss: 0.3229308823492705
Itr: 5	Epoch: 2	Train Acc: 0.21482889733840305	Test Acc: 0.20780537252914344	AVG Train loss: 0.16551232559769327	AVG Test loss: 0.3218662457241362
Itr: 5	Epoch: 3	Train Acc: 0.2340937896070976	Test Acc: 0.22098327420172326	AVG Train loss: 0.16291705317351451	AVG Test loss: 0.3151861580416326
Itr: 5	Epoch: 4	Train Acc: 0.24169835234474019	Test Acc: 0.20628484541307654	AVG Train loss: 0.16151883287971464	AVG Test loss: 0.3152788683462433
Itr: 5	Epoch: 5	Train Acc: 0.23979721166032952	Test Acc: 0.21794221996958946	AVG Train loss: 0.16059426216949227	AVG Test loss: 0.3155442603004202
Itr: 5	Epoch: 6	Train Acc: 0.2556400506970849	Test Acc: 0.20324379118094274	AVG Train loss: 0.15830980979463297	AVG Test loss: 0.3137322891214688
Itr: 5	Epoch: 7	Train Acc: 0.2641318124207858	Test Acc: 0.21439432336543335	AVG Train loss: 0.1577569813971586	AVG Test loss: 0.3135217984678536
Itr: 5	Epoch: 8	Train Acc: 0.2659062103929024	Test Acc: 0.21895590471363405	AVG Train loss: 0.15636164468485292	AVG Test loss: 0.3171466749692048
Itr: 5	Epoch: 9	Train Acc: 0.26818757921419517	Test Acc: 0.21895590471363405	AVG Train loss: 0.15538580614804315	AVG Test loss: 0.31726779551960405
Itr: 5	Epoch: 10	Train Acc: 0.2719898605830165	Test Acc: 0.2351748606183477	AVG Train loss: 0.15434853925413355	AVG Test loss: 0.31449214395870123
Itr: 5	Epoch: 11	Train Acc: 0.2769328263624842	Test Acc: 0.2382159148504815	AVG Train loss: 0.15365453264068138	AVG Test loss: 0.31238336252398863
Itr: 5	Epoch: 12	Train Acc: 0.28986058301647655	Test Acc: 0.23112012164216927	AVG Train loss: 0.15273369890844263	AVG Test loss: 0.31330394699557806
Itr: 5	Epoch: 13	Train Acc: 0.3017743979721166	Test Acc: 0.22453117080587937	AVG Train loss: 0.15130415372692133	AVG Test loss: 0.3091742250213029
Itr: 5	Epoch: 14	Train Acc: 0.2984790874524715	Test Acc: 0.22098327420172326	AVG Train loss: 0.14986042506681196	AVG Test loss: 0.31775673655193587
Itr: 5	Epoch: 15	Train Acc: 0.29569074778200255	Test Acc: 0.23010643689812468	AVG Train loss: 0.14992807375500863	AVG Test loss: 0.30753954472393175
Itr: 5	Epoch: 16	Train Acc: 0.3155893536121673	Test Acc: 0.21946274708565636	AVG Train loss: 0.14761584859308333	AVG Test loss: 0.3068232177419223
Itr: 5	Epoch: 17	Train Acc: 0.3129277566539924	Test Acc: 0.22453117080587937	AVG Train loss: 0.147456913177958	AVG Test loss: 0.30932366062527794
Itr: 5	Epoch: 18	Train Acc: 0.3196451204055767	Test Acc: 0.2326406487582362	AVG Train loss: 0.14725002925300024	AVG Test loss: 0.30676135926819426
Itr: 5	Epoch: 19	Train Acc: 0.32953105196451205	Test Acc: 0.22199695894576787	AVG Train loss: 0.147086878994383	AVG Test loss: 0.3089013488248587
train set ACC of each class tensor([0.0781, 0.0281, 0.0270, 0.0418, 0.0190, 0.0575, 0.0563, 0.0418, 0.0409,
        0.0089])
[[616  36  40  62   7  23  13   4   1   0]
 [249 222  60 134  19  58  32   6   3   0]
 [177  35 213 146  28 119  50  17  13   0]
 [ 75  21  27 330  27 158  83  32  25   0]
 [ 49  15  28 142 150 223 108  40  36   1]
 [ 27  11   8  55  21 454 110  49  44   1]
 [ 12   5   4  51  15 143 444  56  56   2]
 [  5   4   4  37  10 152 170 330  72   3]
 [  9   3   4  17  12 134 162 121 323   6]
 [  6   1   3  24  11 118 175 186 197  70]]
test set ACC of each class tensor([0.0654, 0.0091, 0.0122, 0.0238, 0.0101, 0.0395, 0.0233, 0.0182, 0.0177,
        0.0025])
[[129  13   9  24   2   9   2   1   0   0]
 [ 95  18  30  34   3  15   4   3   2   0]
 [ 40   8  24  53   5  43   9   7   3   1]
 [ 19  10  17  47  15  55  32   6  12   0]
 [ 14   5   9  27  20  75  27   6  13   0]
 [  6   7   6  28   7  78  42  12  17   3]
 [  0   1   2  20  10  61  46  35  18   0]
 [  1   1   1  11   5  53  55  36  25   0]
 [  0   1   1   7   4  39  60  45  35   3]
 [  1   2   2   6   8  28  38  51  55   5]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 6	Epoch: 0	Train Acc: 0.15107731305449937	Test Acc: 0.17942219969589457	AVG Train loss: 0.18163566274618015	AVG Test loss: 0.3307257435736291
Itr: 6	Epoch: 1	Train Acc: 0.20228136882129277	Test Acc: 0.1971616827166751	AVG Train loss: 0.16720216947457786	AVG Test loss: 0.32159783630369887
Itr: 6	Epoch: 2	Train Acc: 0.2102661596958175	Test Acc: 0.1900658895083629	AVG Train loss: 0.16482285747472172	AVG Test loss: 0.32768640126060605
Itr: 6	Epoch: 3	Train Acc: 0.22775665399239545	Test Acc: 0.21844906234161177	AVG Train loss: 0.16189602350270793	AVG Test loss: 0.315352461072798
Itr: 6	Epoch: 4	Train Acc: 0.23967046894803548	Test Acc: 0.20070957932083122	AVG Train loss: 0.16110926548677706	AVG Test loss: 0.3173900699319419
Itr: 6	Epoch: 5	Train Acc: 0.2476552598225602	Test Acc: 0.20425747592498733	AVG Train loss: 0.16029054305040488	AVG Test loss: 0.3127576863469657
Itr: 6	Epoch: 6	Train Acc: 0.24816223067173637	Test Acc: 0.20628484541307654	AVG Train loss: 0.15825650909082215	AVG Test loss: 0.31171622971290874
Itr: 6	Epoch: 7	Train Acc: 0.25158428390367554	Test Acc: 0.20881905727318803	AVG Train loss: 0.15766105958755178	AVG Test loss: 0.3150513923476326
Itr: 6	Epoch: 8	Train Acc: 0.2627376425855513	Test Acc: 0.21996958945767867	AVG Train loss: 0.1562555848107365	AVG Test loss: 0.3119996893892298
Itr: 6	Epoch: 9	Train Acc: 0.27338403041825093	Test Acc: 0.21033958438925493	AVG Train loss: 0.15547466946078797	AVG Test loss: 0.311359491269116
Itr: 6	Epoch: 10	Train Acc: 0.2814955640050697	Test Acc: 0.20324379118094274	AVG Train loss: 0.15359602580260112	AVG Test loss: 0.31772668620413835
Itr: 6	Epoch: 11	Train Acc: 0.2802281368821293	Test Acc: 0.2432843385707045	AVG Train loss: 0.1530267238862463	AVG Test loss: 0.31025186772432295
Itr: 6	Epoch: 12	Train Acc: 0.28871989860583014	Test Acc: 0.22757222503801317	AVG Train loss: 0.15088530986821244	AVG Test loss: 0.30669489229504854
Itr: 6	Epoch: 13	Train Acc: 0.29594423320659063	Test Acc: 0.21135326913329955	AVG Train loss: 0.15008517808843927	AVG Test loss: 0.31449380641622826
Itr: 6	Epoch: 14	Train Acc: 0.28922686945500636	Test Acc: 0.21946274708565636	AVG Train loss: 0.1506121133925117	AVG Test loss: 0.30651360888409845
Itr: 6	Epoch: 15	Train Acc: 0.30228136882129275	Test Acc: 0.22149011657374557	AVG Train loss: 0.14905396158534312	AVG Test loss: 0.3076210476182405
Itr: 6	Epoch: 16	Train Acc: 0.30988593155893535	Test Acc: 0.22757222503801317	AVG Train loss: 0.1493513640993675	AVG Test loss: 0.3063733237939502
Itr: 6	Epoch: 17	Train Acc: 0.31723700887198986	Test Acc: 0.21540800810947794	AVG Train loss: 0.14712447794331343	AVG Test loss: 0.3077878242993923
Itr: 6	Epoch: 18	Train Acc: 0.3115335868187579	Test Acc: 0.2321338063862139	AVG Train loss: 0.14752176440071849	AVG Test loss: 0.30775499206415846
Itr: 6	Epoch: 19	Train Acc: 0.3273764258555133	Test Acc: 0.23568170299037	AVG Train loss: 0.14680451886168905	AVG Test loss: 0.3055115221979288
train set ACC of each class tensor([0.0555, 0.0551, 0.0435, 0.0328, 0.0264, 0.0411, 0.0115, 0.0763, 0.0144,
        0.0324])
[[438 211  91  27   7  13   0  13   0   2]
 [ 87 435 108  51  25  30   2  39   1   5]
 [ 50 146 343  70  40  51   5  82   1  10]
 [ 20 104 105 259  56  81   5 127   3  18]
 [ 10  66  86  76 208 155   4 166   6  15]
 [  4  41  62  49  48 324   7 214   9  22]
 [  5  20  28  46  55 141  91 341  15  46]
 [  1  11  26  17  25  63   8 602   9  25]
 [  1  17  14  19  18  56  12 463 114  77]
 [  2  12  12  20  20  35   4 410  20 256]]
test set ACC of each class tensor([0.0345, 0.0405, 0.0258, 0.0152, 0.0177, 0.0248, 0.0020, 0.0563, 0.0035,
        0.0152])
[[ 68  82  22   7   6   3   0   1   0   0]
 [ 44  80  42  13   6   8   1   8   0   2]
 [ 18  38  51  22  12  26   2  15   3   6]
 [  7  26  43  30  23  36   1  39   4   4]
 [  3  16  20  25  35  48   4  35   4   6]
 [  2  16  13  14  25  49   5  71   2   9]
 [  0   5   6  14  11  45   4  89   7  12]
 [  0   2   8   8  11  28   5 111   4  11]
 [  0   4   2   6   8  15   6 125   7  22]
 [  1   3   6   4   7  11   1 122  11  30]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 7	Epoch: 0	Train Acc: 0.15652724968314322	Test Acc: 0.1910795742524075	AVG Train loss: 0.18053969147559656	AVG Test loss: 0.3285832386208982
Itr: 7	Epoch: 1	Train Acc: 0.19961977186311788	Test Acc: 0.1905727318803852	AVG Train loss: 0.16793318755537537	AVG Test loss: 0.32232412963244617
Itr: 7	Epoch: 2	Train Acc: 0.2191381495564005	Test Acc: 0.20577800304105423	AVG Train loss: 0.1644622299532171	AVG Test loss: 0.3233620075785564
Itr: 7	Epoch: 3	Train Acc: 0.2340937896070976	Test Acc: 0.22047643182970098	AVG Train loss: 0.16264368969243592	AVG Test loss: 0.3153218493824735
Itr: 7	Epoch: 4	Train Acc: 0.24131812420785806	Test Acc: 0.20223010643689812	AVG Train loss: 0.1607884937649444	AVG Test loss: 0.31631702043444626
Itr: 7	Epoch: 5	Train Acc: 0.24347275031685678	Test Acc: 0.20780537252914344	AVG Train loss: 0.1599309798344233	AVG Test loss: 0.3134525062028249
Itr: 7	Epoch: 6	Train Acc: 0.2537389100126743	Test Acc: 0.20273694880892043	AVG Train loss: 0.1580994679249058	AVG Test loss: 0.31182931254826035
Itr: 7	Epoch: 7	Train Acc: 0.2643852978453739	Test Acc: 0.20679168778509882	AVG Train loss: 0.15596030555731594	AVG Test loss: 0.3116193584723939
Itr: 7	Epoch: 8	Train Acc: 0.26552598225602025	Test Acc: 0.22199695894576787	AVG Train loss: 0.15517819392080542	AVG Test loss: 0.31110213649375634
Itr: 7	Epoch: 9	Train Acc: 0.28060836501901143	Test Acc: 0.21794221996958946	AVG Train loss: 0.15357667882897252	AVG Test loss: 0.30819045002697326
Itr: 7	Epoch: 10	Train Acc: 0.27934093789607095	Test Acc: 0.21033958438925493	AVG Train loss: 0.15394303299231674	AVG Test loss: 0.31086572067452395
Itr: 7	Epoch: 11	Train Acc: 0.29569074778200255	Test Acc: 0.21591485048150025	AVG Train loss: 0.15236755419989956	AVG Test loss: 0.31145350554994805
Itr: 7	Epoch: 12	Train Acc: 0.28631178707224336	Test Acc: 0.22351748606183477	AVG Train loss: 0.1522131242773983	AVG Test loss: 0.30945336740148655
Itr: 7	Epoch: 13	Train Acc: 0.2899873257287706	Test Acc: 0.21084642676127724	AVG Train loss: 0.15166324703034642	AVG Test loss: 0.30662044672813743
Itr: 7	Epoch: 14	Train Acc: 0.29885931558935364	Test Acc: 0.22149011657374557	AVG Train loss: 0.15124715321398657	AVG Test loss: 0.30984343952384624
Itr: 7	Epoch: 15	Train Acc: 0.30633713561470216	Test Acc: 0.20729853015712113	AVG Train loss: 0.14961727495353636	AVG Test loss: 0.31039133346207665
Itr: 7	Epoch: 16	Train Acc: 0.30038022813688214	Test Acc: 0.23568170299037	AVG Train loss: 0.15018385912850027	AVG Test loss: 0.3078208931330431
Itr: 7	Epoch: 17	Train Acc: 0.31242078580481625	Test Acc: 0.21236695387734414	AVG Train loss: 0.14749796901403422	AVG Test loss: 0.308519178909876
Itr: 7	Epoch: 18	Train Acc: 0.32078580481622304	Test Acc: 0.22655854029396857	AVG Train loss: 0.14698707414141776	AVG Test loss: 0.3098628091905785
Itr: 7	Epoch: 19	Train Acc: 0.32547528517110264	Test Acc: 0.20932589964521034	AVG Train loss: 0.1470539442033369	AVG Test loss: 0.31025908323211593
train set ACC of each class tensor([0.0749, 0.0322, 0.0473, 0.0327, 0.0255, 0.0653, 0.0267, 0.0309, 0.0345,
        0.0200])
[[591  54  87  31   9  21   6   1   1   1]
 [206 254 160  61  19  65  11   6   1   0]
 [129  37 373  64  29 125  15  15   9   2]
 [ 70  34 128 258  40 192  21  15  14   6]
 [ 41  24  99  67 201 267  24  35  29   5]
 [ 19  18  55  49  42 515  21  27  28   6]
 [ 12   9  32  44  51 314 211  57  48  10]
 [  2   6  25  24  32 304  67 244  62  21]
 [  9   2  20  22  24 255  68  95 272  24]
 [  9   4  13  29  20 242  63 125 128 158]]
test set ACC of each class tensor([0.0578, 0.0162, 0.0258, 0.0132, 0.0122, 0.0482, 0.0061, 0.0096, 0.0127,
        0.0076])
[[114  27  34   5   2   6   1   0   0   0]
 [ 83  32  47  13  12  11   1   3   2   0]
 [ 38  18  51  20  14  35   7   3   4   3]
 [ 20  10  46  26  18  70   9   3   9   2]
 [ 12   9  19  26  24  85   8   5   7   1]
 [  6   9  17  21  13  95  12  18  12   3]
 [  0   1  13  12  12 100  12  22  19   2]
 [  3   1   8   6  13  94  22  19  19   3]
 [  2   0   4   7   7  82  15  42  25  11]
 [  1   2   8   7   5  60  20  31  47  15]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 8	Epoch: 0	Train Acc: 0.14575411913814956	Test Acc: 0.20476431829700964	AVG Train loss: 0.1810580971878593	AVG Test loss: 0.3307217179565821
Itr: 8	Epoch: 1	Train Acc: 0.2011406844106464	Test Acc: 0.20577800304105423	AVG Train loss: 0.16861332747306207	AVG Test loss: 0.3225476173839772
Itr: 8	Epoch: 2	Train Acc: 0.2164765525982256	Test Acc: 0.21692853522554487	AVG Train loss: 0.16423638188793632	AVG Test loss: 0.3195323881707817
Itr: 8	Epoch: 3	Train Acc: 0.22839036755386566	Test Acc: 0.20729853015712113	AVG Train loss: 0.16271729444464048	AVG Test loss: 0.317202167233355
Itr: 8	Epoch: 4	Train Acc: 0.23358681875792142	Test Acc: 0.23314749113025848	AVG Train loss: 0.16159726690562354	AVG Test loss: 0.3132288142457204
Itr: 8	Epoch: 5	Train Acc: 0.2423320659062104	Test Acc: 0.21844906234161177	AVG Train loss: 0.15881530778867362	AVG Test loss: 0.31782410702787556
Itr: 8	Epoch: 6	Train Acc: 0.24879594423320658	Test Acc: 0.21692853522554487	AVG Train loss: 0.15785968026148653	AVG Test loss: 0.3156754155404907
Itr: 8	Epoch: 7	Train Acc: 0.2522179974651457	Test Acc: 0.21490116573745566	AVG Train loss: 0.15719042671950598	AVG Test loss: 0.31189537419924807
Itr: 8	Epoch: 8	Train Acc: 0.2708491761723701	Test Acc: 0.21388748099341104	AVG Train loss: 0.15451636515340575	AVG Test loss: 0.31111561693156725
Itr: 8	Epoch: 9	Train Acc: 0.2721166032953105	Test Acc: 0.21996958945767867	AVG Train loss: 0.15547001608027705	AVG Test loss: 0.3121882862417576
Itr: 8	Epoch: 10	Train Acc: 0.28035487959442335	Test Acc: 0.230613279270147	AVG Train loss: 0.1538262003038848	AVG Test loss: 0.3091111341241164
Itr: 8	Epoch: 11	Train Acc: 0.29391634980988596	Test Acc: 0.230613279270147	AVG Train loss: 0.15145190191680638	AVG Test loss: 0.3059419063795537
Itr: 8	Epoch: 12	Train Acc: 0.2936628643852979	Test Acc: 0.24784591991890523	AVG Train loss: 0.1523750264410057	AVG Test loss: 0.3109663761227009
Itr: 8	Epoch: 13	Train Acc: 0.3053231939163498	Test Acc: 0.22807906741003547	AVG Train loss: 0.1507434800323878	AVG Test loss: 0.31699806514483564
Itr: 8	Epoch: 14	Train Acc: 0.30367553865652724	Test Acc: 0.22453117080587937	AVG Train loss: 0.15055857185647364	AVG Test loss: 0.3057449360033974
Itr: 8	Epoch: 15	Train Acc: 0.30544993662864384	Test Acc: 0.2377090724784592	AVG Train loss: 0.1495132629862303	AVG Test loss: 0.3086003928364562
Itr: 8	Epoch: 16	Train Acc: 0.31140684410646385	Test Acc: 0.22807906741003547	AVG Train loss: 0.1490080409951234	AVG Test loss: 0.3056594874885441
Itr: 8	Epoch: 17	Train Acc: 0.30975918884664133	Test Acc: 0.25291434363912824	AVG Train loss: 0.14779492047330878	AVG Test loss: 0.30557074334738643
Itr: 8	Epoch: 18	Train Acc: 0.3076045627376426	Test Acc: 0.2341611758743031	AVG Train loss: 0.148624022782831	AVG Test loss: 0.3049356390000356
Itr: 8	Epoch: 19	Train Acc: 0.335234474017744	Test Acc: 0.22655854029396857	AVG Train loss: 0.14614795271510256	AVG Test loss: 0.30442675787273904
train set ACC of each class tensor([0.0580, 0.0401, 0.0512, 0.0316, 0.0404, 0.0413, 0.0512, 0.0379, 0.0461,
        0.0466])
[[458 105 134  41  30  15  10   2   3   4]
 [115 316 158  62  60  27  28   6   7   4]
 [ 55  51 404  55  79  56  50  10  16  22]
 [ 24  39 121 249 100  92  73  25  35  20]
 [ 10  19  92  46 319 110  90  32  40  34]
 [  6  19  48  43  90 326 111  39  57  41]
 [  4   7  26  28  68  77 404  61  62  51]
 [  1   4  23  20  44  81 137 299 101  77]
 [  3   3  20  15  31  51 132  85 364  87]
 [  4   2  19  16  38  40 103  71 130 368]]
test set ACC of each class tensor([0.0375, 0.0228, 0.0294, 0.0162, 0.0203, 0.0228, 0.0228, 0.0147, 0.0188,
        0.0213])
[[74 44 48  6 10  6  1  0  0  0]
 [46 45 55 18 17  8  8  2  2  3]
 [16 20 58 24 24 20 11  7  8  5]
 [ 7 10 39 32 44 23 29  5 14 10]
 [ 4  8 20 23 40 37 30 11 15  8]
 [ 2  9 14 12 31 45 43 18 19 13]
 [ 0  2 10  9 20 31 45 22 33 21]
 [ 0  1  6  8 15 29 52 29 27 21]
 [ 0  0  4  2 13 19 54 33 37 33]
 [ 1  2  7  6 11 13 27 29 58 42]]
ConvNet(
  (features): Sequential(
    (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): GroupNorm(128, 128, eps=1e-05, affine=True)
    (2): ReLU(inplace=True)
    (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): GroupNorm(128, 128, eps=1e-05, affine=True)
    (6): ReLU(inplace=True)
    (7): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (8): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): GroupNorm(128, 128, eps=1e-05, affine=True)
    (10): ReLU(inplace=True)
    (11): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Linear(in_features=32768, out_features=10, bias=True)
)
Itr: 9	Epoch: 0	Train Acc: 0.15019011406844107	Test Acc: 0.188545362392296	AVG Train loss: 0.1802855799869364	AVG Test loss: 0.33306245373640336
Itr: 9	Epoch: 1	Train Acc: 0.19429657794676805	Test Acc: 0.20831221490116575	AVG Train loss: 0.16823603154191952	AVG Test loss: 0.32383363034993456
Itr: 9	Epoch: 2	Train Acc: 0.21191381495564005	Test Acc: 0.20476431829700964	AVG Train loss: 0.1644658342362659	AVG Test loss: 0.3194002878662903
Itr: 9	Epoch: 3	Train Acc: 0.22458808618504436	Test Acc: 0.21033958438925493	AVG Train loss: 0.16345473241594505	AVG Test loss: 0.31612211568550114
Itr: 9	Epoch: 4	Train Acc: 0.23016476552598225	Test Acc: 0.21439432336543335	AVG Train loss: 0.16142916945582408	AVG Test loss: 0.3190066410437249
Itr: 9	Epoch: 5	Train Acc: 0.24866920152091254	Test Acc: 0.21388748099341104	AVG Train loss: 0.1586005018341753	AVG Test loss: 0.312575387398845
Itr: 9	Epoch: 6	Train Acc: 0.24816223067173637	Test Acc: 0.22959959452610237	AVG Train loss: 0.1584545548679484	AVG Test loss: 0.31730732715226523
Itr: 9	Epoch: 7	Train Acc: 0.25640050697084915	Test Acc: 0.22098327420172326	AVG Train loss: 0.15706140283207173	AVG Test loss: 0.31143072192371646
Itr: 9	Epoch: 8	Train Acc: 0.2693282636248416	Test Acc: 0.20983274201723265	AVG Train loss: 0.15555945492251594	AVG Test loss: 0.30948402088756677
Itr: 9	Epoch: 9	Train Acc: 0.2656527249683143	Test Acc: 0.21084642676127724	AVG Train loss: 0.15577903976911828	AVG Test loss: 0.3137634291346159
Itr: 9	Epoch: 10	Train Acc: 0.27604562737642585	Test Acc: 0.22706538266599088	AVG Train loss: 0.15330570077733696	AVG Test loss: 0.31228551446062264
Itr: 9	Epoch: 11	Train Acc: 0.2670468948035488	Test Acc: 0.22453117080587937	AVG Train loss: 0.15548495495802853	AVG Test loss: 0.30769052140101283
Itr: 9	Epoch: 12	Train Acc: 0.2828897338403042	Test Acc: 0.20932589964521034	AVG Train loss: 0.1529894330230729	AVG Test loss: 0.3102276495233503
Itr: 9	Epoch: 13	Train Acc: 0.29315589353612165	Test Acc: 0.22706538266599088	AVG Train loss: 0.15156099380044732	AVG Test loss: 0.30829550026789937
Itr: 9	Epoch: 14	Train Acc: 0.2861850443599493	Test Acc: 0.22402432843385708	AVG Train loss: 0.15206298379390412	AVG Test loss: 0.30708978738630116
Itr: 9	Epoch: 15	Train Acc: 0.28871989860583014	Test Acc: 0.2290927521540801	AVG Train loss: 0.15125856547981162	AVG Test loss: 0.3083654801010542
Itr: 9	Epoch: 16	Train Acc: 0.30697084917617234	Test Acc: 0.22706538266599088	AVG Train loss: 0.1501034642958067	AVG Test loss: 0.31055751331886905
Itr: 9	Epoch: 17	Train Acc: 0.31216730038022816	Test Acc: 0.22250380131779016	AVG Train loss: 0.14845554555739135	AVG Test loss: 0.30906599277448243
Itr: 9	Epoch: 18	Train Acc: 0.31863117870722435	Test Acc: 0.2402432843385707	AVG Train loss: 0.14782703999802943	AVG Test loss: 0.3073767997094114
Itr: 9	Epoch: 19	Train Acc: 0.32775665399239545	Test Acc: 0.22098327420172326	AVG Train loss: 0.1464596406560207	AVG Test loss: 0.30446381104880643
train set ACC of each class tensor([0.0669, 0.0427, 0.0275, 0.0420, 0.0361, 0.0548, 0.0551, 0.0200, 0.0360,
        0.0431])
[[528 112  36  66  22  20  12   2   0   4]
 [149 337  57  98  42  51  36   4   5   4]
 [108  94 217 121  85  88  51   2   9  23]
 [ 35  61  32 331  73 118  82   8  14  24]
 [ 20  27  24 100 285 171  92  14  29  30]
 [  6  24  13  60  53 432 106  13  43  30]
 [  7   9   3  47  56 126 435  17  38  50]
 [  2   5   5  28  42 166 208 158  76  97]
 [  4  10   4  21  26 121 173  50 284  98]
 [  4   4   2  30  27  63 156  49 116 340]]
test set ACC of each class tensor([0.0461, 0.0269, 0.0091, 0.0172, 0.0198, 0.0335, 0.0279, 0.0071, 0.0106,
        0.0228])
[[91 44 14 26  8  5  1  0  0  0]
 [62 53 17 44 11  9  3  2  2  1]
 [29 28 18 41 22 32 12  2  3  6]
 [11 17 22 34 45 40 25  2  7 10]
 [ 6 11  6 31 39 60 23  4 10  6]
 [ 4 12  4 33 20 66 34  4 18 11]
 [ 0  2  2 17 13 52 55 12 21 19]
 [ 1  0  2 10 14 44 61 14 22 20]
 [ 0  1  1 11 10 30 62 26 21 33]
 [ 1  2  3  7  6 20 49 15 48 45]]
Saving {path_to_buffer_storage}\dl-DR17-Pipe3D\ConvNet\replay_buffer_0.pt
C:/Users/EXCAE/PycharmProjects/Galaxy-Dataset-Distillation/buffer.py:171: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  plt.figure(figsize=(12, 7))

Process finished with exit code 0
